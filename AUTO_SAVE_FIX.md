# ุฅุตูุงุญ ูุดููุฉ ุงูุญูุธ ุงูุชููุงุฆู ูุนุฏู ุธููุฑ ุงูููุงุญุธุงุช

## ๐ ุงููุดููุฉ
1. ุงูุญูุธ ุงูุชููุงุฆู ูุงู ููุดุฆ ููุงุญุธุงุช ุฌุฏูุฏุฉ ุจุฏูุงู ูู ุชุญุฏูุซ ููุณ ุงูููุงุญุธุฉ
2. ุงูููุงุญุธุงุช ุงููุญููุธุฉ ูุง ุชุธูุฑ ููุฑุงู ูู ุตูุญุฉ ุงูููุงุญุธุงุช ุจุนุฏ ุงูุฎุฑูุฌ ูู ุตูุญุฉ ุงููุชุงุจุฉ

## โ ุงูุญููู ุงููุทุจูุฉ

### 1. ุชุชุจุน ูุนุฑูู ุงูููุงุญุธุฉ (`rich_note_editor.dart`)
```dart
String? _savedNoteId; // ูุนุฑูู ุงูููุงุญุธุฉ ุงููุญููุธุฉ
```
- ุฅุถุงูุฉ ูุชุบูุฑ ูุญูุธ ูุนุฑูู ุงูููุงุญุธุฉ ุจุนุฏ ุฃูู ุญูุธ
- ุงุณุชุฎุฏุงู ููุณ ุงููุนุฑูู ูู ุนูููุงุช ุงูุญูุธ ุงููุงุญูุฉ

### 2. ุชุญุฏูุซ Repository ูุฅุฑุฌุงุน ูุนุฑูู ุงูููุงุญุธุฉ (`notes_repository.dart`)
```dart
Future<String?> saveNoteToFolder(..., {String? noteId, ...})
```
- ุชุบููุฑ ููุน ุงูุฅุฑุฌุงุน ูู `Future<bool>` ุฅูู `Future<String?>`
- ุฅุฑุฌุงุน ูุนุฑูู ุงูููุงุญุธุฉ ุนูุฏ ุงููุฌุงุญ ุฃู `null` ุนูุฏ ุงููุดู
- ุงุณุชุฎุฏุงู `noteId` ุงูููุฌูุฏ ุฃู ุฅูุดุงุก ุฌุฏูุฏ ุจู `Uuid().v4()`

### 3. ุงูุชุนุงูู ูุน SQLite ูSharedPreferences
**SQLite:**
- ุจุนุฏ ุงูุญูุธ ูู SQLiteุ ุฅุนุงุฏุฉ ูุฑุงุกุฉ ุงูููุงุญุธุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุญุฏูุซ ุงูุฐุงูุฑุฉ (in-memory) ุจุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
```dart
final notesResult = await _store.getNotesByFolderId(folderId);
folder.notes.clear();
folder.notes.addAll(notesResult.data!);
```

**SharedPreferences:**
- ุงูุจุญุซ ุนู ุงูููุงุญุธุฉ ุงูููุฌูุฏุฉ ุจููุณ `noteId`
- ุชุญุฏูุซ ุงูููุงุญุธุฉ ุฅุฐุง ููุฌุฏุชุ ุฃู ุฅุถุงูุฉ ููุงุญุธุฉ ุฌุฏูุฏุฉ
- ุงูุญูุงุธ ุนูู `createdAt` ุงูุฃุตูู ุนูุฏ ุงูุชุญุฏูุซ

### 4. ุฅุบูุงู ุตูุญุฉ ุงููุชุงุจุฉ ูุน ุฅุฑุฌุงุน ูุชูุฌุฉ (`rich_note_editor.dart`)
```dart
onWillPop: () async {
  _autoSaveTimer?.cancel();
  if (_hasContent) {
    await _saveNote(showMessage: false);
    Navigator.pop(context, true); // ุฅุฑุฌุงุน true
    return false; // ููุน ุงูุฅุบูุงู ุงูุชููุงุฆู
  }
  return true;
}
```

### 5. ุชุญุฏูุซ ูุงุฌูุฉ ุตูุญุฉ ุงูููุงุญุธุงุช (`folder_notes_screen.dart`)
```dart
if (result == true && mounted) {
  debugPrint('๐ ุชุญุฏูุซ ุงููุงุฌูุฉ...');
  setState(() {}); // ุฅุนุงุฏุฉ ุจูุงุก ุงููุงุฌูุฉ
}
```

## ๐ Debug Prints ุงููุถุงูุฉ
- `๐พ RichNoteEditor: ุญูุธ ุงูููุงุญุธุฉ - noteId ุงูุญุงูู`
- `โ RichNoteEditor: ุชู ุงูุญูุธ ุจูุฌุงุญ - noteId`
- `๐ FolderNotesScreen: ุนุฑุถ X ููุงุญุธุฉ`
- `๐ ุชุญุฏูุซ ุงูุฐุงูุฑุฉ ูู SQLite - ุนุฏุฏ ุงูููุงุญุธุงุช`
- `NotesRepository: using id = X`

## ๐ ุณูุฑ ุงูุนูู ุงูุฌุฏูุฏ
1. ุงููุณุชุฎุฏู ููุชุญ ุตูุญุฉ ุงููุชุงุจุฉ โ `_savedNoteId = null`
2. ููุชุจ ูุญุชูู ููุชู ุงูุญูุธ ุงูุชููุงุฆู
3. `saveNoteToFolder` ูููุดุฆ `noteId` ุฌุฏูุฏ (ุฃูู ูุฑุฉ)
4. ููุฑุฌุน `noteId` ูููุญูุธ ูู `_savedNoteId`
5. ุงูุญูุธ ุงูุชููุงุฆู ุงูุชุงูู ูุณุชุฎุฏู ููุณ `_savedNoteId` โ ุชุญุฏูุซ
6. ุนูุฏ ุงูุฎุฑูุฌ: ุญูุธ โ `Navigator.pop(context, true)`
7. ุตูุญุฉ ุงูููุงุญุธุงุช: `setState()` โ ุชุญุฏูุซ ุงููุงุฌูุฉ
8. ุงูููุงุญุธุฉ ุชุธูุฑ ููุฑุงู! โจ

## ๐ฏ ุงููุชูุฌุฉ
- โ ููุงุญุธุฉ ูุงุญุฏุฉ ููุท ูุชู ุญูุธูุง (ูุง ุชูุฑุงุฑ)
- โ ุงูููุงุญุธุงุช ุชุธูุฑ ููุฑุงู ุจุนุฏ ุงูุฎุฑูุฌ ูู ุตูุญุฉ ุงููุชุงุจุฉ
- โ ุงูุชูุงูู ูุน SQLite ูSharedPreferences
- โ ุงูุญูุธ ุงูุชููุงุฆู ูุนูู ูู 5 ุซูุงูู
- โ ุงูุญูุธ ุนูุฏ ุงูุฎุฑูุฌ ุจุฏูู ุชุฃููุฏ

## ๐ ุงูุชุงุฑูุฎ
6 ุฃูุชูุจุฑ 2025
